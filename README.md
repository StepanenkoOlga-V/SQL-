# SQL-
## Итоговый учебный проект 

Во время обучения был выполнен итоговый проект по теме «SQL и получение данных».

- Цель проекта: выполнение запросов, согласно заданиям (9 задач)

- Оценка проекта: для зачета необходимо набрать минимум 130 баллов максимум 200 баллов

- Достижение цели: 195 баллов.

<img width="370" height="107" alt="image" src="https://github.com/user-attachments/assets/9c4968a4-d355-4e77-8c06-d6545d499830" />


## Выполненный проект:  

[Описание базы данных](https://edu.postgrespro.ru/bookings.pdf)


#### №1-- Выведите названия самолетов, которые имеют менее 50 посадочных мест

<img width="446" height="89" alt="image" src="https://github.com/user-attachments/assets/534aae60-2a9e-4d3d-ac21-025c9089f11f" />


#### №2 --Выведите процентное изменение ежемесячной суммы бронирования билетов, окгругленной до сотых

<img width="649" height="88" alt="image" src="https://github.com/user-attachments/assets/b8ed2fb4-53f4-4725-a4f7-984e7be46af3" />


#### №3 -- Выведите названия самолетов без бизнес-класса. Используйте в решении функцию  array-agg

<img width="450" height="90" alt="image" src="https://github.com/user-attachments/assets/65141a4b-af97-4ce5-be99-2eab8bcbba79" />


#### №4 Выведите накопительный итог количества мест в самолётах по каждому аэропорту на каждый день. 
##### _Учтите только те самолеты, которые летали пустыми и только те дни, когда из одного аэропорта вылетело более одного такого самолёта._
##### _Выведите в результат код аэропорта, дату вылета, количество пустых мест и накопительный итог._
 
<img width="700" height="500" alt="image" src="https://github.com/user-attachments/assets/94211dac-7840-4991-a898-d19a319e365b" />

#### №5 Найдите процентное соотношение перелётов по маршрутам от общего количества перелётов. 
##### _Выведите в результат названия аэропортов и процентное отношение._
##### _Используйте в решении оконную функцию._

<img width="656" height="88" alt="image" src="https://github.com/user-attachments/assets/8ab2c6d1-63e7-4125-bcb6-8eb0d38b0e2d" />

#### №6 Выведите количество пассажиров по каждому коду сотового оператора. 
##### _Код оператора – это три символа после +7_


<img width="371" height="85" alt="image" src="https://github.com/user-attachments/assets/636794b0-e0be-43cb-bf7a-b9ea55861ca7" />


#### №7 Классифицируйте финансовые обороты (сумму стоимости перелетов) по маршрутам:
##### _●	до 50 млн – low_
##### _●	от 50 млн включительно до 150 млн – middle_
##### _●	от 150 млн включительно – high_
##### _Выведите в результат количество маршрутов в каждом полученном классе._

<img width="512" height="155" alt="image" src="https://github.com/user-attachments/assets/b1b3cd6c-04d9-4e60-b8f9-61fe4316fc16" />


#### №8 Вычислите медиану стоимости перелетов, медиану стоимости бронирования 
#### и отношение медианы бронирования к медиане стоимости перелетов, результат округлите до сотых.

<img width="707" height="83" alt="image" src="https://github.com/user-attachments/assets/1ffddb9b-4590-4bd5-a5e7-0dffa5696877" />

#### №9 Найдите значение минимальной стоимости одного километра полёта для пассажира.
##### _Для этого определите расстояние между аэропортами и учтите стоимость перелета._


<img width="638" height="189" alt="image" src="https://github.com/user-attachments/assets/98fe4427-52a2-4f88-961a-00093e8a0ed0" />


  
